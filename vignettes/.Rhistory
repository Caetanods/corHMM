set.seed(1985)
setwd("~/corHMM/vignettes/")
require(ape)
require(expm)
require(corHMM)
data(primates)
phy <- read.tree("randomBD.tree")
load("simulatedData.Rsave")
head(Precur_Dat)
Precur_LegendAndMat <- getStateMat4Dat(Precur_Dat)
Precur_LegendAndMat
Precur_R1 <- Precur_LegendAndMat$rate.mat
Precur_R1 <- dropStateMatPars(Precur_R1, c(1,2))
Precur_R1
Precur_R2 <- Precur_LegendAndMat$rate.mat
Precur_R2 <- equateStateMatPars(Precur_R2, c(1,2))
RateClassMat <- getRateCatMat(2) #
RateClassMat <- equateStateMatPars(RateClassMat, c(1,2))
Precur_FullMat <- getFullMat(list(Precur_R1, Precur_R2), RateClassMat)
Precur_FullMat[c(4,2), c(2,4)] <- 0
Precur_res.corHMM <- corHMM(phy = phy, data = Precur_Dat, rate.cat = 2, rate.mat = Precur_FullMat, root.p=NULL, node.states = "marginal", get.tip.states = TRUE)
Precur_res.corHMM
Precur_res.corHMM$tip.states
Precur_res.corHMM <- corHMM(phy = phy, data = Precur_Dat, rate.cat = 2, rate.mat = Precur_FullMat, root.p="yang", node.states = "marginal", get.tip.states = TRUE)
Precur_res.corHMM$tip.states
Precur_res.corHMM$states
Precur_res.corHMM <- corHMM(phy = phy, data = Precur_Dat, rate.cat = 2, root.p="yang", node.states = "marginal", get.tip.states = TRUE)
Precur_res.corHMM$tip.states
